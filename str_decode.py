import binascii
import string
import random


def generate_random_token():
    return random.choices(string.ascii_lowercase, k=6) + random.choices(string.digits, k=6)


def decode_string(zero_val, dec_string):
    key = binascii.unhexlify("000000006410B71DC8206E3BAC30D9269041DC76F4516B6B5861B24D3C7105502083B8ED44930FF0E8A3D6D68"
                             "CB361CBB0C2649BD4D2D38678E20AA01CF2BDBD")

    idx = 0
    res_val = ~zero_val
    while idx < len(dec_string):
        temp_val = key[(dec_string[idx] ^ res_val) & 0xF] ^ ((dec_string[idx] ^ res_val) >> 4)
        res_val = key[temp_val & 0xF] ^ (temp_val >> 4)
        idx += 1

    return ~res_val
